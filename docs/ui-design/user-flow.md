# ユーザーフロー図

## 一般ユーザーの本人確認フロー

```mermaid
flowchart TD
    Start([開始]) --> Home[ホーム画面]
    Home --> |「本人確認を開始」クリック| Intro[本人確認開始画面]
    Intro --> |「カメラを起動」クリック| Camera[カメラ撮影画面]
    
    Camera --> |「撮影」クリック| TakePhoto[写真撮影]
    TakePhoto --> Preview[プレビュー・確認画面]
    
    Preview --> |「撮り直す」クリック| Camera
    Preview --> |「この画像を使用する」クリック| Upload[画像アップロード処理]
    
    Upload --> |アップロード成功| Complete[完了画面]
    Upload --> |アップロード失敗| Error[エラー表示]
    Error --> Camera
    
    Complete --> |「ホームに戻る」クリック| Home
    
    subgraph "エラーハンドリング"
        CameraError[カメラアクセスエラー] --> |「設定を確認」クリック| Settings[ブラウザ設定]
        CameraError --> |「キャンセル」クリック| Home
        
        UploadError[アップロードエラー] --> |「再試行」クリック| Upload
        UploadError --> |「キャンセル」クリック| Home
    end
```

## 管理者の本人確認審査フロー

```mermaid
flowchart TD
    Start([開始]) --> Dashboard[管理者ダッシュボード]
    Dashboard --> |「本人確認リクエスト一覧」クリック| List[本人確認要求一覧画面]
    
    List --> |リクエスト選択| Detail[確認詳細画面]
    
    Detail --> |「承認」クリック| Approve[承認処理]
    Detail --> |「却下」クリック| Reject[却下処理]
    
    Approve --> |コメント入力| ApproveConfirm[承認確認]
    Reject --> |理由入力| RejectConfirm[却下確認]
    
    ApproveConfirm --> |「確定」クリック| Process[処理実行]
    RejectConfirm --> |「確定」クリック| Process
    
    Process --> Result[処理結果画面]
    Result --> |「一覧に戻る」クリック| List
    
    subgraph "フィルタリングと検索"
        Filter[フィルタ適用] --> List
        Search[検索実行] --> List
    end
```

## 情報の流れ

### 一般ユーザーフロー
1. **ホーム画面**
   - 入力: なし
   - 出力: ユーザーの操作選択

2. **本人確認開始画面**
   - 入力: なし
   - 出力: ユーザーの同意情報

3. **カメラ撮影画面**
   - 入力: カメラデバイスからの映像ストリーム
   - 出力: 撮影された画像データ

4. **プレビュー・確認画面**
   - 入力: 撮影された画像データ
   - 出力: ユーザーの確認結果（承認/撮り直し）

5. **完了画面**
   - 入力: アップロード結果
   - 出力: なし

### 管理者フロー
1. **管理者ダッシュボード**
   - 入力: システム統計データ
   - 出力: ユーザーの操作選択

2. **本人確認要求一覧画面**
   - 入力: 本人確認リクエストデータ
   - 出力: 選択されたリクエスト

3. **確認詳細画面**
   - 入力: 選択されたリクエストの詳細データ
   - 出力: 審査結果（承認/却下）とコメント

4. **処理結果画面**
   - 入力: 処理結果
   - 出力: なし

## 必要なデータ要素

### 一般ユーザーフロー
- ユーザーID
- セッション情報
- カメラデバイス情報
- 撮影画像データ
- アップロード状態
- エラー情報（発生時）

### 管理者フロー
- 管理者ID
- 本人確認リクエスト一覧
  - リクエストID
  - ユーザー情報
  - 提出日時
  - 現在のステータス
- リクエスト詳細情報
  - 画像データ
  - メタデータ（撮影日時、デバイス情報など）
- 審査結果
  - 承認/却下ステータス
  - コメント
  - 処理日時 